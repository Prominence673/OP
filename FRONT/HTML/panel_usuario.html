<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Datos personales - ViajesMundo</title>
  <link rel="stylesheet" href="../CSS/panel_usuario.css"/>
  <link rel="stylesheet" href="../CSS/header-footer.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
</head>
<body>
<header class="site-header">
  <div class="container header-container">
    <h1>TRAVEL</h1>
    <nav class="main-nav">
      <ul class="nav-menu">
        <li><a href="index.html">Inicio</a></li>
        <li class="dropdown-parent">
          <button class="dropdown-toggle" aria-haspopup="true" aria-expanded="false">
            Paquetes <i class="fa-solid fa-chevron-down"></i>
          </button>
          <ul class="submenu">
            <li><a href="#">Alquiler coches</a></li>
            <li><a href="paquetes.html">Paquetes turisticos</a></li>
            <li><a href="#">Estadias</a></li>
            <li><a href="#">Pasajes a√©reos</a></li>
          </ul>
        </li>
        <li><a href="#contacto">Contacto</a></li>
      </ul>
    </nav>
    <div class="user-menu">
      <a href="carrito.html" aria-label="Ir al carrito de compras" class="icon-link">
        <i class="fa-solid fa-cart-shopping user-icon"></i>
      </a>
      <button id="user-menu-btn" aria-label="Men√∫ de usuario" class="icon-btn">
        <i class="fa-solid fa-user user-icon"></i>
      </button>
      <ul class="dropdown">
        <li id="user"></li>
        <li id="panel_usuario"><a href="panel_usuario.html">Panel</a></li>
        <li id="login_panel"><a href="login.html">Iniciar sesi√≥n</a></li>
        <li id="register_panel"><a href="register.html">Registrarse</a></li>
        <li><a href="#" id="logout">Cerrar Sesion</a></li>
      </ul>
    </div>
</header>
<main class="panel-container">
  <aside class="sidebar">
    <div class="sidebar-card">
      <h3>üöÄ Plane√° tu nuevo viaje!</h3>
      <p>Aprovech√° las ofertas en alojamientos, vuelos, actividades y mucho m√°s.</p>
      <button class="btn-purple" onclick="redirigir()">Encontr√° tu vuelo</button>
    </div>
    <ul class="sidebar-menu">
      <li><a href="panel_usuario.html">Datos personales</a></li>
      <li><a href="tarjeta.html">Medios de pago</a></li>
      <li><a href="notificaciones.html">Notificaciones sobre cambios</a></li>
      <li><a href="pasajeros.html">Pasajeros</a></li>
      <li><a href="opiniones.html">Opiniones</a></li>
      <li><a href="sesiones.html">Sesiones activas</a></li>
      <li><a href="eliminar.html">Eliminar cuenta</a></li>
    </ul>
  </aside>

  <section class="main-panel">
    <section class="panel-section">
      <h2><span style="color:#ccc;">Mi Perfil /</span> Datos personales</h2>

      <div class="payment-option" style="border-top: 5px solid #8dc8f3; background-color: #0077cc; display: flex; align-items: center;">
<form id="formFoto" method="post" enctype="multipart/form-data">
  <input type="hidden" name="action" value="guardar_foto" />
  <label for="fotoPerfil" style="cursor:pointer;">
    <img id="preview" src="..." />
    <input type="file" id="fotoPerfil" name="fotoPerfil" accept="image/*" style="display:none"/>
  </label>
  <button type="submit">Guardar Foto</button>
</form>
        <p style="color:#fff; font-weight: bold;">
          <i class="fas fa-user-circle"></i> <b class="email"></b> <i class="fas fa-check-circle" style="color:#a5ffaf"></i>
        </p>
      </div>

     <form id="formDatos" method="post" style="display: flex; flex-direction: column; gap: 1rem;">
      <input type="hidden" name="action" value="guardar_datos" />
  <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
    <div style="flex: 1;">
      <label for="name">Nombres</label>
      <input type="text" id="name" name="name" placeholder="Como figura en el documento de viaje" style="width: 50%;" required max="50"/>
    </div>
    <div style="flex: 1;">
      <label for="surname">Apellidos</label>
      <input type="text" id="surname" name="surname" placeholder="Como figura en el documento de viaje" style="width: 50%;" required max="50"/>
    </div>
  </div>

  <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
    <div style="flex: 1;">
      <label>Fecha de nacimiento</label>
      <div style="display: flex; gap: 0.5rem;">
        <select id="dia" name="dia" style="flex: 1;"></select>
        <select id="mes" name="mes" style="flex: 1;"></select>
        <select id="anio" name="anio" style="flex: 1;"></select>
      </div>
    </div>
    <div style="flex: 1;">
      <label>G√©nero</label>
      <div style="display: flex; gap: 1rem; margin-top: 0.5rem;">
        <label for="Femenino">Femenino</label>
          <input type="radio" name="genero" id="Femenino" value="Femenino"> 
          
        <label for="Masculino">Masculino</label>
          <input type="radio" name="genero" id="Masculino" value="Masculino" checked> 
          
      </div>
    </div>
  </div>
  <div id="mensajeDiv" style="color: green;"></div>
  <div id="mensajeDatos" style="color: green;"></div>
  <button class="btn-purple" type="submit">Guardar</button>
</form>
      <div class="payment-option" style="margin-top: 2rem;">
        <h3>Tel√©fonos</h3>
        <p>Agreg√° tus tel√©fonos para que podamos contactarte en caso que ocurra alg√∫n cambio.</p>
        <button class="btn-outline" onclick="document.getElementById('telefonoForm').classList.toggle('hidden')">+ Agregar tel√©fono</button>
        <form id="telefonoForm" method="post" class="hidden">
          <input type="hidden" name="action" value="guardar_telefono" />
          <input type="tel" name="telefono" id="telefono" placeholder="Ej: +54 9 11 1234-5678" style="width: 12.5%;" required>
          <div id="mensajeTelefono" style="color: green;"></div>
          <button type="submit" class="btn-purple">Guardar tel√©fono</button>
        </form>
      </div>
      <div class="payment-option" style="margin-top: 1.5rem;">
      <h3>Verificaci√≥n de Email</h3>
      <p>
        ¬øNo recibiste el correo de verificaci√≥n o cambiaste tu email? Hac√© clic en el bot√≥n para reenviar el enlace de verificaci√≥n.
      </p>
      <form id="verificarEmailForm" method="post">
        <input type="hidden" name="action" value="verificar_email" />
        <div id="mensajeVerificarEmail" style="color: green;"></div>
        <button type="submit" class="btn-outline">
          <i class="fas fa-paper-plane"></i> Enviar verificaci√≥n
        </button>
      </form>
      <div id="mensajeVerificacion" style="margin-top: 0.5rem; font-weight: bold;"></div>
    </div>
      <div class="payment-option" style="margin-top: 1.5rem;">
        <h3>Email</h3>
        <p>Cambia el email vinculado a esta cuenta, Recuerda que solo podras hacerlo una vez cada 30 dias.</p>
        <p><i class="fas fa-envelope"></i> <b class="email"></b> <span style="color:green;">&#10004; Verificado</span> - <strong>Principal</strong></p>
        <form id="formEmail" method="post">
          <input type="hidden" name="action" value="guardar_email" />
          <input type="email" name="email" id="email" placeholder="Nuevo email" style="width: 12.5%;" required>
          <div id="mensajeCambiarEmail" style="color: green;"></div>
          <button type="submit" class="btn-outline"><i class="fas fa-pen"></i> Cambiar Email</button>
        </form>
      </div>

      <div class="payment-option" style="margin-top: 1.5rem;">
        <h3>Contrase√±a</h3>
        <p><i class="fas fa-lock"></i> ‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</p>
        <button class="btn-outline" onclick="document.getElementById('formPass').classList.toggle('hidden')"><i class="fas fa-pen"></i> Cambiar contrase√±a</button>
        <form id="formPass" method="post" class="hidden">
          <input type="hidden" name="action" value="cambiar_contrase√±a" />
          <input type="password" name="currentpassword" id="currentpassword" placeholder="Contrase√±a actual" style="width: 12.5%; display: block;" maxlength="16" required>
          <div class="form-group password-wrapper">
          <input type="password" name="password" id="password" placeholder="Nueva contrase√±a" style="width: 12.5%; display: block;" maxlength="16" required>
          <div id="password-rules">
            <p id="min-length">8 caracteres</p>
            <p id="lowercase">Una min√∫scula</p>
            <p id="uppercase">Una may√∫scula</p>
            <p id="number">Un n√∫mero</p>
            <p id="special">Un car√°cter especial @ # $ ^ & + = . ! ? - _ *</p>
          </div>
          <input type="password" name="confirmpassword" id="confirmpassword" placeholder="Repetir nueva contrase√±a" style="width: 12.5%; display: block;" maxlength="16" required>
          <div class="custom-checkbox-group">
            <input type="checkbox" id="show-password" name="show-password" style="display: block;"/>
            <label for="show-password">Mostrar contrase√±a</label>
          </div>
          <div id="mensajeCambiarContrase√±a" style="color: green;"></div>
          <button class="btn-purple" type="submit">Actualizar</button>
        </div>
        </div>
        </div>
        </form>
      </div>
    </section>
  </section>
</main>
<script src="../../BACK/JS LOGICA/passParameters.js"></script>
<script>
  const fotoInput = document.getElementById('fotoPerfil');
  const preview = document.getElementById('preview');

  fotoInput.addEventListener('change', function () {
    const file = this.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function (e) {
        preview.src = e.target.result;
      }
      reader.readAsDataURL(file);
    }
  });

  const dia = document.getElementById("dia");
  const mes = document.getElementById("mes");
  const anio = document.getElementById("anio");

  const meses = [
    "Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio",
    "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"
  ];

  meses.forEach((m, i) => {
    const opt = document.createElement("option");
    opt.value = i + 1;
    opt.textContent = m;
    mes.appendChild(opt);
  });

  function actualizarDias() {
    dia.innerHTML = "";
    const mesSeleccionado = parseInt(mes.value);
    const anioSeleccionado = parseInt(anio.value);
    const diasEnMes = new Date(anioSeleccionado, mesSeleccionado, 0).getDate();
    for (let i = 1; i <= diasEnMes; i++) {
      const opt = document.createElement("option");
      opt.value = i;
      opt.textContent = i;
      dia.appendChild(opt);
    }
  }

  for (let y = 1925; y <= 2007; y++) {
    const opt = document.createElement("option");
    opt.value = y;
    opt.textContent = y;
    anio.appendChild(opt);
  }

  mes.addEventListener("change", actualizarDias);
  anio.addEventListener("change", actualizarDias);
  anio.value = "2001";
  mes.value = "8";
  actualizarDias();
  dia.value = "17";
  function redirigir() {
    setTimeout(function() {
      window.location.href = "paquetes.html";
    }); 
  }
</script>
  <script src="../../BACK/JS LOGICA/sessionActivate.js"></script>
    <script>
  const actions = new SessionActions();
  actions.Disabled(["#login_panel", "#register_panel"],"none", "0.5");
  actions.Activate(["#panel_usuario", "#logout"], "none", "0.5");
  actions.InsertData("#user", "nombre");
  actions.InsertData(".email", "email");
  actions.checkSessionAndRedirectIfNotLoggedIn("login.html");
  const logout = document.getElementById("logout");

  logout.addEventListener("click", () => {
    actions.logoutSession();
  });
  </script>
  <script src="../JS DISE√ëO/menu.js"></script>
  <script src="../../BACK/JS LOGICA/submitdata.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
  new FormHandler({
    formSelector: "#formDatos", 
    endpoint: "../../BACK/PHP/user_panel.php",  
    messageTarget: mensajeDatos
  });
  });
  //passParameters
  document.addEventListener("DOMContentLoaded", () => {
    new PasswordValidator({
      passwordSelector: "#password",
      confirmSelector: "#currentpassword",
      toggleSelector: "#show-password",
      rulesContainerSelector: "#password-rules",
      formSelector: "#register",
      ruleSelectors: {
        minLength: "#min-length",
        lowercase: "#lowercase",
        uppercase: "#uppercase",
        number: "#number",
        special: "#special"
      }
    });
  });
    document.addEventListener("DOMContentLoaded", () => {
    new PasswordValidator({
      passwordSelector: "#password",
      confirmSelector: "#confirmpassword",
      toggleSelector: "#show-password",
      rulesContainerSelector: "#password-rules",
      formSelector: "#register",
      ruleSelectors: {
        minLength: "#min-length",
        lowercase: "#lowercase",
        uppercase: "#uppercase",
        number: "#number",
        special: "#special"
      }
    });
  });
  </script>
  <script>
       
    document.addEventListener("DOMContentLoaded", () => {
  new FormHandler({
    formSelector: "#telefonoForm", 
    endpoint: "../../BACK/PHP/user_panel.php",  
    messageTarget: mensajeTelefono
  });
  });
  </script>
   <script>

    document.addEventListener("DOMContentLoaded", () => {
  new FormHandler({
    formSelector: "#verificarEmailForm",  
    endpoint: "../../BACK/PHP/user_panel.php",  
    messageTarget: mensajeVerificarEmail
  });
  });
  </script>
   <script>
  
    document.addEventListener("DOMContentLoaded", () => {
  new FormHandler({
    formSelector: "#formPass",  
    endpoint: "../../BACK/PHP/user_panel.php",  
    messageTarget: mensajeCambiarContrase√±a 
  });
  });
  </script>
   <script>
       
    document.addEventListener("DOMContentLoaded", () => {
  new FormHandler({
    formSelector: "#formEmail", 
    endpoint: "../../BACK/PHP/user_panel.php",  
    messageTarget: mensajeCambiarEmail
  });
  });
  </script>
  <script src="../../BACK/JS LOGICA/submitfiles.js"></script>
    <script>

    document.addEventListener("DOMContentLoaded", () => {
  new FileUploader({
    formSelector: "#formFoto",
    endpoint: "../../BACK/PHP/user_panel.php",
    messageTarget: mensajeDiv,
    fileInputName: "fotoPerfil"
  });
  });
  </script>
<style>
.hidden { display: none; }
</style>
<footer class="site-footer center">
    <p>&copy; 2025 ViajesMundo. Todos los derechos reservados.</p>
  </footer>
</body>
</html>
