<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Datos personales - ViajesMundo</title>
  <link rel="stylesheet" href="../CSS/header-footer.css"/>
  <link rel="stylesheet" href="../CSS/panel_usuario.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
</head>
<body>
<header class="site-header">
  <div class="container header-container">
    <h1>TRAVEL</h1>
    <nav class="main-nav">
      <ul class="nav-menu">
        <li><a href="index.html">Inicio</a></li>
        <li class="dropdown-parent">
          <button class="dropdown-toggle" aria-haspopup="true" aria-expanded="false">
            Paquetes <i class="fa-solid fa-chevron-down"></i>
          </button>
          <ul class="submenu">
            <li><a href="#">Alquiler coches</a></li>
            <li><a href="paquetes.html">Paquetes turisticos</a></li>
            <li><a href="#">Estadias</a></li>
            <li><a href="#">Pasajes a√©reos</a></li>
          </ul>
        </li>
        <li><a href="#contacto">Contacto</a></li>
      </ul>
    </nav>
    <div class="user-menu">
      <a href="carrito.html" aria-label="Ir al carrito de compras" class="icon-link">
        <i class="fa-solid fa-cart-shopping user-icon"></i>
      </a>
      <button id="user-menu-btn" aria-label="Men√∫ de usuario" class="icon-btn">
        <i class="fa-solid fa-user user-icon"></i>
      </button>
      <ul class="dropdown">
        <li id="user"></li>
        <li id="panel_usuario"><a href="panel_usuario.html">Panel</a></li>
        <li id="login_panel"><a href="login.html">Iniciar sesi√≥n</a></li>
        <li id="register_panel"><a href="register.html">Registrarse</a></li>
        <li><a href="#" id="logout">Cerrar Sesi√≥n</a></li>
      </ul>
    </div>
  </div>
</header>

<main class="panel-container">
  <aside class="sidebar">
    <div class="sidebar-card">
      <h3>üöÄ Plane√° tu nuevo viaje!</h3>
      <p>Aprovech√° las ofertas en alojamientos, vuelos, actividades y mucho m√°s.</p>
      <button class="btn-purple" onclick="window.location.href='paquetes.html'">Encontr√° tu vuelo</button>
    </div>
    <ul class="sidebar-menu">
      <li><a href="panel_usuario.html"><i class="fas fa-user"></i> Datos personales</a></li>
      <li><a href="tarjeta.html"><i class="fas fa-credit-card"></i> Medios de pago</a></li>
      <li><a href="pasajeros.html"><i class="fas fa-users"></i> Pasajeros</a></li>
      <li><a href="opiniones.html"><i class="fas fa-star"></i> Opiniones</a></li>
      <li><a href="eliminar.html"><i class="fas fa-trash-alt"></i> Eliminar cuenta</a></li>
    </ul>
  </aside>

  <section class="main-panel">
    <section class="panel-section">
      <h2><span>Mi Perfil</span> / Datos personales</h2>
      
      <div class="user-profile-header">
        <div class="user-avatar">
          <i class="fas fa-user"></i>
        </div>
        <div class="user-info">
          <h3 id="user-name">Nombre Apellido</h3>
          <p class="email"><i class="fas fa-envelope"></i> usuario@email.com <i class="fas fa-check-circle verified"></i></p>
        </div>
      </div>

      <form id="formDatos" method="post">
        <input type="hidden" name="action" value="guardar_datos" />
        
        <div class="form-section">
          <h3><i class="fas fa-id-card"></i> Informaci√≥n b√°sica</h3>
          <p>Actualiz√° tus datos personales para una mejor experiencia.</p>
          
          <div class="form-grid">
            <div class="form-group">
              <label for="name">Nombres</label>
              <input type="text" id="name" name="name" placeholder="Como figura en el documento" required maxlength="50"/>
            </div>
            <div class="form-group">
              <label for="surname">Apellidos</label>
              <input type="text" id="surname" name="surname" placeholder="Como figura en el documento" required maxlength="50"/>
            </div>
          </div>
          
          <div class="form-grid">
            <div class="form-group">
              <label>Fecha de nacimiento</label>
              <div style="display: flex; gap: 0.5rem;">
                <select id="dia" name="dia" style="flex: 1;"></select>
                <select id="mes" name="mes" style="flex: 1;"></select>
                <select id="anio" name="anio" style="flex: 1;"></select>
              </div>
            </div>
            <div class="form-group">
              <label>G√©nero</label>
              <div style="display: flex; gap: 1rem; margin-top: 0.5rem;">
                <label><input type="radio" name="genero" value="Femenino"> Femenino</label>
                <label><input type="radio" name="genero" value="Masculino" checked> Masculino</label>
              </div>
            </div>
          </div>
          
          <button class="btn-outline" type="submit">Guardar cambios</button>
        </div>
      </form>

      <div class="form-section">
        <h3><i class="fas fa-phone"></i> Tel√©fonos</h3>
        <p>Agreg√° tus tel√©fonos para que podamos contactarte.</p>
        
        <button class="btn-outline" onclick="document.getElementById('telefonoForm').classList.toggle('hidden')">
          <i class="fas fa-plus"></i> Agregar tel√©fono
        </button>
        
        <form id="telefonoForm" method="post" class="hidden" style="margin-top: 1.5rem;">
          <input type="hidden" name="action" value="guardar_telefono" />
          <div class="form-grid">
            <div class="form-group">
              <label for="telefono">N√∫mero de tel√©fono</label>
              <input type="tel" name="telefono" id="telefono" placeholder="Ej: +54 9 11 1234-5678" required>
            </div>
          </div>
          <button class="btn-primary" type="submit">Guardar tel√©fono</button>
        </form>
      </div>

      <div class="form-section">
        <h3><i class="fas fa-envelope"></i> Email</h3>
        <p>Cambi√° el email vinculado a esta cuenta.</p>
        
        <form id="formEmail" method="post">
          <input type="hidden" name="action" value="guardar_email" />
          <div class="form-grid">
            <div class="form-group">
              <label for="email">Nuevo email</label>
              <input type="email" name="email" id="email" placeholder="nuevo@email.com" required>
            </div>
          </div>
          <button class="btn-outline" type="submit">
            <i class="fas fa-paper-plane"></i> Cambiar Email
          </button>
        </form>
      </div>

      <div class="form-section">
        <h3><i class="fas fa-lock"></i> Contrase√±a</h3>
        <p>Cambi√° tu contrase√±a peri√≥dicamente para mayor seguridad.</p>
        
        <button class="btn-outline" onclick="document.getElementById('formPass').classList.toggle('hidden')">
          <i class="fas fa-pen"></i> Cambiar contrase√±a
        </button>
        
        <form id="formPass" method="post" class="hidden" style="margin-top: 1.5rem;">
          <input type="hidden" name="action" value="cambiar_contrase√±a" />
          <div class="form-grid">
            <div class="form-group">
              <label for="currentpassword">Contrase√±a actual</label>
              <input type="password" name="currentpassword" id="currentpassword" placeholder="Contrase√±a actual" required>
            </div>
          </div>
          <div class="form-grid">
            <div class="form-group">
              <label for="password">Nueva contrase√±a</label>
              <input type="password" name="password" id="password" placeholder="Nueva contrase√±a" required>
            </div>
            <div class="form-group">
              <label for="confirmpassword">Confirmar nueva contrase√±a</label>
              <input type="password" name="confirmpassword" id="confirmpassword" placeholder="Repetir nueva contrase√±a" required>
            </div>
          </div>
          <div class="form-group">
            <label><input type="checkbox" id="show-password"> Mostrar contrase√±as</label>
          </div>
          <button class="btn-primary" type="submit">Actualizar contrase√±a</button>
        </form>
      </div>
    </section>
  </section>
</main>

<script>
// Configuraci√≥n de fecha de nacimiento
const dia = document.getElementById("dia");
const mes = document.getElementById("mes");
const anio = document.getElementById("anio");

const meses = [
  "Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio",
  "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"
];

meses.forEach((m, i) => {
  const opt = document.createElement("option");
  opt.value = i + 1;
  opt.textContent = m;
  mes.appendChild(opt);
});

function actualizarDias() {
  dia.innerHTML = "";
  const mesSeleccionado = parseInt(mes.value);
  const anioSeleccionado = parseInt(anio.value);
  const diasEnMes = new Date(anioSeleccionado, mesSeleccionado, 0).getDate();
  for (let i = 1; i <= diasEnMes; i++) {
    const opt = document.createElement("option");
    opt.value = i;
    opt.textContent = i;
    dia.appendChild(opt);
  }
}

for (let y = 1925; y <= 2007; y++) {
  const opt = document.createElement("option");
  opt.value = y;
  opt.textContent = y;
  anio.appendChild(opt);
}

mes.addEventListener("change", actualizarDias);
anio.addEventListener("change", actualizarDias);
anio.value = "2001";
mes.value = "8";
actualizarDias();
dia.value = "17";

// Mostrar/ocultar contrase√±as
document.getElementById('show-password').addEventListener('change', function() {
  const current = document.getElementById('currentpassword');
  const newPass = document.getElementById('password');
  const confirm = document.getElementById('confirmpassword');
  const type = this.checked ? 'text' : 'password';
  
  current.type = type;
  newPass.type = type;
  confirm.type = type;
});
</script>

<script src="../../BACK/JS LOGICA/sessionActivate.js"></script>
<script>
const actions = new SessionActions();
actions.Disabled(["#login_panel", "#register_panel"],"none", "0.5", "none");
actions.Activate(["#panel_usuario", "#logout"], "none", "0.5", "none" );
actions.InsertData("#user", "nombre");
actions.InsertData("#user-name", "nombre");
actions.InsertData(".email", "email");
actions.checkSessionAndRedirectIfNotLoggedIn("login.html");

const logout = document.getElementById("logout");
logout.addEventListener("click", () => {
  actions.logoutSession();
});
</script>

<script src="../JS DISE√ëO/menu.js"></script>
<script src="../../BACK/JS LOGICA/submitdata.js"></script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  new FormHandler({
    formSelector: "#formDatos", 
    endpoint: "../../BACK/PHP/user_panel.php",  
    messageTarget: document.createElement('div') // Ajustar seg√∫n necesidad
  });
  
  new FormHandler({
    formSelector: "#telefonoForm", 
    endpoint: "../../BACK/PHP/user_panel.php",  
    messageTarget: document.createElement('div')
  });
  
  new FormHandler({
    formSelector: "#formEmail", 
    endpoint: "../../BACK/PHP/user_panel.php",  
    messageTarget: document.createElement('div')
  });
  
  new FormHandler({
    formSelector: "#formPass", 
    endpoint: "../../BACK/PHP/user_panel.php",  
    messageTarget: document.createElement('div')
  });
});
</script>

<style>
.hidden { display: none; }
</style>

<footer class="site-footer">
  <div class="container">
    <p>&copy; 2025 ViajesMundo. Todos los derechos reservados.</p>
  </div>
</footer>
</body>
</html>